---
import { Dropdown as NavDropdown, DropdownItems } from 'astro-navbar'

interface Props {
  user?: {
    id: string
    email?: string
    firstName?: string
    lastName?: string
    avatar?: string
  }
}

const { user } = Astro.props

const userName = user?.firstName && user?.lastName ? `${user.firstName} ${user.lastName}` : user?.email || 'User'
---

<div class="relative isolate z-50">
  <NavDropdown class="group">
    <button class="text-color-default border-color-default hover:bg-color-default-default flex cursor-pointer items-center gap-2 rounded-full border border-solid px-3 py-1 text-base">
      <i class="fa-solid fa-bars"></i>
      <plus-avatar size="sm" status="primary" name={userName}></plus-avatar>
    </button>

    <DropdownItems>
      <div class:list={['z-50 w-full origin-top-right border-l border-color-disabled lg:absolute lg:right-0 lg:w-48 lg:border-0']}>
        <div class="flex flex-col px-3 lg:rounded-md  lg:bg-color-surface lg:py-2 lg:px-1 lg:shadow">
          <!-- User Info Header -->
          <div class="border-b border-color-disabled px-3 py-3 lg:px-2 lg:py-3">
            <div class="flex items-center gap-3">
              <plus-avatar status="primary" name={userName}></plus-avatar>
              <div class="min-w-0 flex-1">
                <p class="truncate text-sm font-medium text-color-default">{userName}</p>
                <p class="truncate text-xs text-color-caption">{user?.email}</p>
              </div>
            </div>
          </div>

          <!-- Navigation Links -->
          <div class="py-1">
            <a href="/dashboard" class="flex items-center gap-3 px-3 py-2 text-sm text-color-default transition-colors duration-200 hover:bg-color-default-hovered lg:px-4">
              <i class="fas fa-tachometer-alt w-4 text-color-default"></i>
              <span>Dashboard</span>
            </a>

            <a href="/dashboard/profile" class="flex items-center gap-3 px-3 py-2 text-sm text-color-default transition-colors duration-200 hover:bg-color-default-hovered lg:px-4">
              <i class="fas fa-user w-4 text-color-default"></i>
              <span>Profile</span>
            </a>

            <a href="/dashboard/settings" class="flex items-center gap-3 px-3 py-2 text-sm text-color-default transition-colors duration-200 hover:bg-color-default-hovered lg:px-4">
              <i class="fas fa-cog w-4 text-color-default"></i>
              <span>Settings</span>
            </a>
          </div>

          <!-- Divider -->
          <div class="border-t border-color-disabled py-1">
            <a href="/" class="flex items-center gap-3 px-3 py-2 text-sm text-color-default transition-colors duration-200 hover:bg-color-default-hovered lg:px-4">
              <i class="fas fa-question-circle w-4 text-color-default"></i>
              <span>Help & Support</span>
            </a>

            <a href="/" class="flex items-center gap-3 px-3 py-2 text-sm text-color-default transition-colors duration-200 hover:bg-color-default-hovered lg:px-4">
              <i class="fas fa-book w-4 text-color-default"></i>
              <span>Documentation</span>
            </a>
          </div>

          <!-- Sign Out -->
          <div class="border-t border-color-disabled py-1">
            <a href="/logout" class="flex items-center gap-3 px-3 py-2 text-sm text-color-default transition-colors duration-200 hover:bg-color-default-hovered lg:px-4">
              <i class="fas fa-sign-out-alt w-4 text-color-caption"></i>
              <span>Sign out</span>
            </a>
          </div>
        </div>
      </div>
    </DropdownItems>
  </NavDropdown>
</div>
