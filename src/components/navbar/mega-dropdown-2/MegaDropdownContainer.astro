---
import ProductCard from "./ProductCard.astro";
import DiscoverSection from "./DiscoverSection.astro";

const { title, type = "products", children } = Astro.props;
---



<div class="relative group">
  <!-- Dropdown Button -->
  <button
    class="flex lg:px-3 py-1.5 font-sans-tight text-base font-normal tracking-[0.01em] items-center gap-1.5 w-full lg:w-auto transition text-color-default hover:text-indigo-600 focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-indigo-500 focus-visible:outline-none focus-visible:shadow-outline-indigo rounded-full cursor-pointer"
  >
    <span>{title}</span>
    <svg
      xmlns="http://www.w3.org/2000/svg"
      fill="none"
      viewBox="0 0 24 24"
      stroke-width="3"
      stroke="currentColor"
      class="w-3 h-3 mt-0.5 transition-transform group-hover:rotate-180"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        d="M19.5 8.25l-7.5 7.5-7.5-7.5"
      ></path>
    </svg>
  </button>

  <!-- Mega Dropdown Menu -->
  <div class="fixed top-18 left-1/2 transform -translate-x-1/2 z-50 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200">
    <div class="bg-white shadow-xl border border-gray-200 rounded-lg p-6" style="width: min(calc(80rem + 40px), 90vw);">
      
      {type === "products" && (
        <!-- Products Grid - 4 Columns -->
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
          {children.map((item) => (
            <ProductCard item={item} />
          ))}
        </div>
      )}

      {type === "discover" && (
        <!-- Discover Grid - 5 Columns -->
        <div class="grid grid-cols-1 lg:grid-cols-5 gap-8">
          {children.map((section) => (
            <DiscoverSection section={section} />
          ))}
        </div>
      )}

    </div>
  </div>
</div>

<!-- Mobile fallback - simple dropdown -->
<div class="lg:hidden">
  <details class="group">
    <summary class="flex lg:px-3 py-1.5 font-sans-tight text-base font-normal tracking-[0.01em] items-center gap-1.5 w-full lg:w-auto transition text-color-default hover:text-indigo-600 cursor-pointer list-none">
      <span>{title}</span>
      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="3"
        stroke="currentColor"
        class="w-3 h-3 mt-0.5 transition-transform group-open:rotate-180"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M19.5 8.25l-7.5 7.5-7.5-7.5"
        ></path>
      </svg>
    </summary>
    
    <div class="mt-2 space-y-2 pl-4">
      {children.map((item) => (
        <a href={item.path} class="block py-2 text-sm text-gray-600 hover:text-indigo-600 transition-colors">
          {item.title}
        </a>
      ))}
    </div>
  </details>
</div> 