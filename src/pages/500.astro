---
import Layout from '@layouts/Layout.astro'
import Container from '@components/common/container.astro'

interface Props {
  error?: unknown
}

const { error } = Astro.props

// Safe error message
const getErrorMessage = (error: unknown): string => {
  if (error instanceof Error) {
    if (import.meta.env.PROD) {
      return 'A server error occurred.'
    }
    return error.message || 'Unknown server error'
  }
  return 'An unexpected server error occurred.'
}

const errorMessage = getErrorMessage(error)
const isDev = import.meta.env.DEV
---

<Layout 
  title="Server Error - 500"
  theme="light"
  headerTheme="light"
>
  <main class="min-h-screen flex items-center">
    <Container>
      <div class="mx-auto max-w-md text-center">
        <h1 class="mb-4 text-8xl font-bold text-gray-300">500</h1>
        <h2 class="mb-4 text-2xl font-semibold text-color-default">Server Error</h2>
        <p class="mb-8 text-color-muted">Something went wrong on our end. Please try again later.</p>
        
        {isDev && error && (
          <div class="mb-8 p-4 bg-red-50 border border-red-200 rounded-lg text-left">
            <h3 class="font-semibold text-red-800 mb-2">Development Error:</h3>
            <code class="text-sm text-red-700 whitespace-pre-wrap break-all">
              {errorMessage}
            </code>
          </div>
        )}
        
        <div class="flex gap-4 justify-center">
          <a 
            href="/" 
            class="px-6 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors"
          >
            Go Home
          </a>
          
          <button 
            onclick="window.location.reload()" 
            class="px-6 py-3 border border-gray-300 text-color-default font-medium rounded-lg hover:bg-gray-50 transition-colors"
          >
            Retry
          </button>
        </div>
      </div>
    </Container>
  </main>
</Layout>
